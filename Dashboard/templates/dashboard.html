{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Dashboard - AutoIntern</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f7fc;
      padding: 40px;
      color: #333;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 800px;
      margin: 0 auto 20px;
    }

    .logout-form {
      margin: 0;
    }

    .logout-form button {
      padding: 8px 16px;
      background: #ff4b5c;
      color: white;
      border: none;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }

    .logout-form button:hover {
      background: #e60027;
    }

    h1 {
      text-align: center;
      color: #4a63e7;
    }

    form {
      max-width: 800px;
      margin: 30px auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    }

    label {
      font-weight: 600;
      display: block;
      margin: 10px 0 5px;
    }

    textarea,
    input {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 20px;
    }

    button[type="submit"] {
      padding: 12px 20px;
      background: #4a63e7;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
    }

    button[type="submit"]:hover {
      background: #3247cc;
    }

    .results {
      max-width: 1200px;
      /* Increased width */
      margin: 30px auto;
      background: #e8f0fe;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    }

    .result-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 15px;
      /* Slightly larger font */
    }

    .result-table th,
    .result-table td {
      padding: 14px;
      /* Increased cell padding */
      border: 1px solid #ccc;
      text-align: left;
    }

    .about-section {
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
  </style>
</head>

<body>

  <div class="top-bar">
    <h1>Internship Search Dashboard</h1>
    <form method="post" action="{% url 'logout' %}" class="logout-form">
      {% csrf_token %}
      <button type="submit">Logout</button>
    </form>
  </div>

  <form method="POST">
    {% csrf_token %}
    <label for="urls">Enter Internship URLs (use comma for separation):</label>
    <textarea id="urls" name="urls" rows="5"
      placeholder="https://internshala.com/internships/python-django-internship">{{ request.POST.urls }}</textarea>

    <label for="keywords">Enter Skill Keywords to Search (comma-separated):</label>
    <input type="text" id="keywords" name="keywords" placeholder="django, data science, remote"
      value="{{ request.POST.keywords }}">

    <label for="start_page">Start Page:</label>
    <input type="number" id="start_page" name="start_page" value="{{ request.POST.start_page|default:1 }}">

    <label for="end_page">End Page:</label>
    <input type="number" id="end_page" name="end_page" value="{{ request.POST.end_page|default:3 }}">

    <button type="submit">Search Internships</button>
  </form>
  <!-- Loading message (hidden by default) -->
  <div id="loading" style="display:none; color: green; font-weight: bold; text-align:center; margin-top: 10px;">
    ðŸ”„ Scraping internships... Please wait.
  </div>

  <script>
    // Show loading message on form submit
    document.querySelector("form").addEventListener("submit", function () {
      document.getElementById("loading").style.display = "block";
    });
  </script>


  {% if internships %}
  <div class="results">
    <h2>Matched Internships:</h2>
    <table class="result-table">
      <thead>
        <tr>
          <th>#</th>
          <th>Title</th>
          <th>Location</th>
          <th>Stipend</th>
          <th>Posted</th>
          <th>Start</th>
          <th>Apply By</th>
          <th>Duration</th>
          <th>Skills</th>
          <th>Link</th>
        </tr>
      </thead>
      <tbody>
        {% for i in internships %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>{{ i.1 }}</td>
          <td>{{ i.2 }}</td>
          <td>{{ i.3 }}</td>
          <td>{{ i.4 }}</td>
          <td>{{ i.5 }}</td>
          <td>{{ i.6 }}</td>
          <td>{{ i.7 }}</td>
          <td>{{ i.8|join:", " }}</td>
          <td><a href="{{ i.9 }}" target="_blank">View</a></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endif %}

  <div class="about-section">
    <h2>About AutoIntern</h2>
    <p>AutoIntern is a smart internship finder that helps students find relevant internships across multiple platforms
      by automating the search and filtering process using advanced scraping techniques. This tool is built with Django,
      BeautifulSoup, and Python, aiming to streamline career opportunities for budding developers and professionals.</p>
  </div>
</body>

</html>